{"payload":{"meta":{"Graph":{"@Type":"81297157","@Value":{"Guid":"(Guid)53540dd5-7b95-4fc6-97ad-2a38d18b6dbf","ParentGuid":"(Guid)2fbba09b-2b13-413f-adb8-36d728ecbad7","Name":"(string)PRG_SQlite","Properties":{"@Type":"2c41fa04:IDictionary","@Value":{}},"TypeGuid":"(Guid)6f9dac99-8de1-4efc-8465-68ac443b7d08","EmbeddedTypeGuids":{"@Type":"[Guid]","@Value":["(Guid)a9ed5b7e-75c5-4651-af16-d2c27e98cb94","(Guid)3b83b776-fb25-43b8-99f2-3c507c9143fc"]}}},"TypeInfos":{"2c41fa04":"{2c41fa04-1834-41c1-816e-303c7aa2c05b}","81297157":"{81297157-7ec9-45ce-845e-84cab2b88ade}","Guid":"System.Guid","string":"System.String"}},"object":{"Graph":{"@Type":"6f9dac99","@Value":{"SpecialFunc":{"@Type":"0db3d7bb:Enum","@Value":"None"},"Implementation":{"@Type":"3b83b776","@Value":{"TextDocument":{"@Type":"f3878285","@Value":{"TextBlobForSerialisation":"(string)(* state machine *)\nIF xSQlite_Enable THEN\n\tCASE iState OF\n\t\t0\t:\t// idle\n\t\t\t\txSQlite_ClearLog := xSQlite_ClearLog;\n\t\t\t\tIF xSQlite_Connect THEN\n\t\t\t\t\tiState := 10;\n\t\t\t\tELSIF xSQlite_Disconnect THEN\n\t\t\t\t\tiState := 80;\n\t\t\t\tELSIF xSQlite_CreateTab THEN\n\t\t\t\t\tiState := 20;\n\t\t\t\tELSIF xSQlite_LogData THEN\n\t\t\t\t\tiState := 40;\n\t\t\t\tELSIF xSQlite_ReadData THEN\n\t\t\t\t\tiState := 50;\n\t\t\t\tEND_IF\n\t\t\t\tsState := 'SQlite idle - wait for command';\n\t\t\t\t\n\t\t10\t:\t// open tDB\n\t\t\t\tIF oSQlite.open(sPath := sSQlite_DBpath, sFilename := sSQlite_Filename, xOnSDCard := xSQlite_OnSDcard, xClassicPath := xSQlite_ClassicPath, xBeginTransaction := xSQlite_BeginTransac, xError => xSQlite_Err, sStatus => sSQlite_Status, xDbExists => xSQlite_DBexist) THEN\n\t\t\t\t\tIF \txSQlite_Err THEN\n\t\t\t\t\t\tiState := 99;\n\t\t\t\t\t\tsState := 'SQlite open DB - open error';\n\t\t\t\t\tELSE\n\t\t\t\t\t\tiState := 11;\n\t\t\t\t\t\tsState := 'SQlite open DB - openning DB';\n\t\t\t\t\tEND_IF\n\t\t\t\tEND_IF\n\t\t\n\t\t11\t:\t// log\n\t\t\t\tiState := 12;\n\t\t\t\tsState := sSQlite_Status;\n\t\t\t\t\t\t\n\t\t12\t:\t// DB is open\n\t\t\t\txSQlite_Connect := FALSE;\n\t\t\t\tiState := 0;\n\t\t\t\tsState := 'SQlite open DB - DB is open';\n\t\t\t\t\n\t\t20\t:\t// create table\n\t\t\t\t//sSQL_Statement := 'CREATE TABLE IF NOT EXISTS table_test(id INTEGER PRIMARY KEY AUTOINCREMENT, Val_1 INTEGER, Val_2 REAL, Val_3 TEXT, Val_4 INTEGER)';\n\t\t\t\tsSQL_Statement := 'CREATE TABLE IF NOT EXISTS table_test(Val_1 INTEGER, Val_2 REAL, Val_3 TEXT, Val_4 INTEGER)';\n\t\t\t\toSQlite.executeSQLCommand(\n\t\t\t\t\tsSQLrequest := sSQL_Statement,\n\t\t\t\t\txError => xSQlite_Err,\n\t\t\t\t\tsStatus => sSQlite_Status);\n\t\t\t\tiState := 21;\n\t\t\t\tsState := 'SQlite create table - create';\n\t\t\t\t\n\t\t21\t:\t// finalize\n\t\t\t\tIF xSQlite_Err THEN\n\t\t\t\t\tiState := 99;\n\t\t\t\t\tsState := 'SQlite create table - error';\n\t\t\t\tELSE\n\t\t\t\t\toSQlite.finalize();\n\t\t\t\t\tiState := 22;\n\t\t\t\t\tsState := sSQlite_Status;\t\t\t\t\t\n\t\t\t\tEND_IF\n\t\t\t\txSQlite_LogData := FALSE;\n\t\t\t\t\n\t\t22\t:\t// create table, done\n\t\t\t\txSQlite_CreateTab := FALSE;\n\t\t\t\tiState := 0;\n\t\t\t\tsState := 'SQlite create table - done';\n\t\t\t\t\n\t\t40\t:\t// log data, prepare statement\n\t\t\t\tsSQL_Statement := 'INSERT INTO table_test VALUES (?,?,?,?)';\t//(iValue INTEGER, sValue TEXT, rValue REAL, diValue DINT, lrValue DOUBLE, liValue INTEGER, xValue INTEGER)\n\t\t\t\toSQlite.insertData4(\n\t\t\t\t\tsSQLrequest := sSQL_Statement,\n\t\t\t\t\tvalue1 := iValue,\n\t\t\t\t\tvalue2 := rValue,\n\t\t\t\t\tvalue3 := sValue,\n\t\t\t\t\tvalue4 := xValue,\n\t\t\t\t\txError => xSQlite_Err,\n\t\t\t\t\tsStatus => sSQlite_Status);\n\t\t\t\tiState := 41;\n\t\t\t\tsState := 'SQlite log data - write';\n\t\t\t\t\n\t\t41\t:\t// finalize\n\t\t\t\tIF xSQlite_Err THEN\n\t\t\t\t\tiState := 99;\n\t\t\t\t\tsState := 'SQlite log data - error';\n\t\t\t\tELSE\n\t\t\t\t\toSQlite.finalize();\n\t\t\t\t\tiState := 42;\n\t\t\t\t\tsState := sSQlite_Status;\t\t\t\t\t\n\t\t\t\tEND_IF\n\t\t\t\t\n\t\t42\t:\t// log data, done\t\t\t\t\n\t\t\t\txSQlite_LogData := FALSE;\t\t\t\n\t\t\t\tiState := 0;\n\t\t\t\tsState := 'SQlite log data - done';\t\n\t\t\t\t\n\t\t50\t:\t// read data, prepare statement\n\t\t\t\tsSQL_Statement := 'SELECT * FROM table_test';\n\t\t\t\tFOR i:= 1 TO c_iMaxTableSize DO\n\t\t\t\t\tIF NOT oSQlite.getData4(\n\t\t\t\t\t\tsSQLrequest := sSQL_Statement,\n\t\t\t\t\t\tvalue1 := aTableValues[i].iValue,\n\t\t\t\t\t\tvalue2 := aTableValues[i].rValue,\n\t\t\t\t\t\tvalue3 := aTableValues[i].sValue,\n\t\t\t\t\t\tvalue4 := aTableValues[i].xValue,\n\t\t\t\t\t\txError => xSQlite_Err,\n\t\t\t\t\t\tsStatus => sSQlite_Status) THEN\n\t\t\t\t\t\t\tEXIT; //If no data available or error, exit from the loop\n\t\t\t\t\tEND_IF\n\t\t\t\tEND_FOR\n\t\t\t\toSQlite.finalize();\n\t\t\t\t\n\t\t\t\txSQlite_ReadData := FALSE;\n\t\t\t\tiState := 0;\n\t\t\t\t\n\t\t80\t:\t// close DB\n\t\t\t\tIF oSQlite.close(xCommitTransaction := TRUE, xError := xSQlite_Err, sStatus := sSQlite_Status) THEN\n\t\t\t\t\tiState := 81;\n\t\t\t\t\tsState := 'SQlite close DB - closing DB';\t\t\t\t\t\n\t\t\t\tEND_IF\n\t\t\t\t\n\t\t81\t:\t// log\n\t\t\t\tiState := 82;\n\t\t\t\tsState := sSQlite_Status;\n\t\t\t\t\n\t\t82\t:\t// DB is close\n\t\t\t\txSQlite_Disconnect := FALSE;\n\t\t\t\tiState := 0;\n\t\t\t\tsState := 'SQlite close DB - DB is closed';\t\t\t\t\n\t\t\n\t\t99\t:\t// error handling\n\t\t\t\tsState := sSQlite_Status;\n\tELSE\n\t\tiState := 0;\n\tEND_CASE\nELSE\n\txSQlite_Connect := FALSE;\n\txSQlite_Disconnect := FALSE;\n\txSQlite_CreateTab := FALSE;\n\txSQlite_LogData := FALSE;\n\txSQlite_ReadData := FALSE;\n\tiState := 0;\nEND_IF\n\n{region 'magt-state-fuffer'}\n\tIF sState <> aState[0] THEN \n\t\tFOR i:= c_iStateBufferSize TO 1 BY -1 DO\n\t\t\taState[i] := aState[i-1];\n\t\tEND_FOR\n\tEND_IF\n\taState[0] := sState;\n\tIF xSQlite_ClearLog\tTHEN\n\t\tFOR i:= 0 TO c_iStateBufferSize DO\n\t\t\taState[i] := '';\n\t\tEND_FOR\n\t\txSQlite_ClearLog := FALSE;\n\tEND_IF\n{endregion}","LineInfoPersistence":"(string)53540dd5-7b95-4fc6-97ad-2a38d18b6dbf_Impl_LineIds"}}}},"Interface":{"@Type":"a9ed5b7e","@Value":{"TextDocument":{"@Type":"f3878285","@Value":{"TextBlobForSerialisation":"(string)PROGRAM PRG_SQlite\nVAR\n\tiState\t\t\t\t\t\t\t: INT;\n\tsState\t\t\t\t\t\t\t: STRING;\n\taState\t\t\t\t\t\t\t: ARRAY[0..c_iStateBufferSize] OF STRING;\n\txSQlite_Enable\t\t\t\t\t: BOOL := TRUE;\n\txSQlite_Connect\t\t\t\t\t: BOOL;\n\txSQlite_Disconnect\t\t\t\t: BOOL;\n\txSQlite_CreateTab\t\t\t\t: BOOL;\n\txSQlite_LogData\t\t\t\t\t: BOOL;\n\txSQlite_ReadData\t\t\t\t: BOOL;\n\txSQlite_ClearLog\t\t\t\t: BOOL;\n\t\n\ti\t\t\t\t\t\t\t\t: INT;\n\t\n\tsSQlite_DBpath\t\t\t\t\t: STRING := '/media/sd/sqlite';\n\tsSQlite_Filename\t\t\t\t: STRING := 'db1';\n\txSQlite_OnSDcard\t\t\t\t: BOOL := FALSE;\n\txSQlite_ClassicPath\t\t\t\t: BOOL := FALSE;\n\t\n\tsSQL_Statement\t\t\t\t\t: STRING(255);\n\tiValue\t\t\t\t\t\t\t: INT := 12345;\n\trValue\t\t\t\t\t\t\t: REAL := 3.14159;\n\tsValue\t\t\t\t\t\t\t: STRING := 'hello';\n\txValue\t\t\t\t\t\t\t: BOOL;\n\t\n\taTableValues\t\t\t\t\t: ARRAY[1..c_iMaxTableSize] OF typSQlite_TableTest;\n\t\n\t(* instances *)\n\toSQlite\t\t\t\t\t\t\t: WagoSysSQLite_FR.FbSQLite;\n\txSQlite_BeginTransac \t\t\t: BOOL;\n\txSQlite_Err\t\t\t\t\t\t: BOOL;\n\tsSQlite_Status\t\t\t\t\t: STRING;\n\txSQlite_DBexist\t\t\t\t\t: BOOL;\n\t\n\t\n\t\nEND_VAR\nVAR CONSTANT\n\tc_iStateBufferSize\t\t\t\t: INT := 19;\n\tc_iMaxTableSize\t\t\t\t\t: INT := 99;\nEND_VAR","LineInfoPersistence":"(string)53540dd5-7b95-4fc6-97ad-2a38d18b6dbf_Decl_LineIds"}}}},"UniqueIdGenerator":"(string)514","POULevel":{"@Type":"8e575c5b:Enum","@Value":"Standard"},"ChildObjectGuids":{"@Type":"ArrayList:IList","@Value":[]},"AddAttributeSubsequent":"(bool)False"}},"TypeInfos":{"0db3d7bb":"{0db3d7bb-cde0-4416-9a7b-ce49a0124323}","3b83b776":"{3b83b776-fb25-43b8-99f2-3c507c9143fc}","6f9dac99":"{6f9dac99-8de1-4efc-8465-68ac443b7d08}","8e575c5b":"{8e575c5b-1d37-49c6-941b-5c0ec7874787}","a9ed5b7e":"{a9ed5b7e-75c5-4651-af16-d2c27e98cb94}","ArrayList":"System.Collections.ArrayList","bool":"System.Boolean","f3878285":"{f3878285-8e4f-490b-bb1b-9acbb7eb04db}","string":"System.String"}}},"FormatVersion":"1.0"}